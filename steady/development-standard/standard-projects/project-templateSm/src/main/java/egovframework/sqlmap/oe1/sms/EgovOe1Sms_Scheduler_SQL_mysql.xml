<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="SysLog">

	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<!-- 시스템로그 VO -->	
	<typeAlias  alias="scheLog" type="egovframework.oe1.sms.schedule.service.EgovOe1SmsSchedulerVO"/>
	
	<resultMap id="schedule" class="egovframework.oe1.sms.schedule.service.EgovOe1SmsSchedulerVO">
		<result property="logId" column="LOG_ID"/>
		<result property="logSe" column="LOG_SE"/>
		<result property="jobNm" column="JOB_NM"/>
		<result property="jobGroupNm" column="JOB_GROUP_NM"/>
		<result property="jobExecutTime" column="JOB_EXECUT_TIME"/>
		<result property="logMssage" column="LOG_MSSAGE"/>
	</resultMap>	
	
	<!-- 시스템 로그 등록 -->
	<insert id="EgovOe1SmsScheduleDAO.insertScheduleLog" parameterClass="scheLog" >
		<![CDATA[
			INSERT INTO OE1TNSMSSCHELOG 
				( LOG_ID
				  , LOG_SE
				  , JOB_NM
				  , JOB_GROUP_NM
				  , JOB_EXECUT_TIME
				  , LOG_MSSAGE
				  )
			VALUES ( #logId#
				  , #logSe#
				  , #jobNm#
				  , #jobGroupNm#
				  , #jobExecutTime#
				  , #logMssage#
				  )
		]]>
	</insert>
	
	<select id="EgovOe1SmsScheduleDAO.selectScheduleLog" resultMap="schedule">
		<![CDATA[
			SELECT
				LOG_ID, LOG_SE, JOB_NM, JOB_GROUP_NM, JOB_EXECUT_TIME, LOG_MSSAGE
			FROM OE1TNSMSSCHELOG 
			WHERE LOG_ID=#logId#
		]]>
	</select>
	
	<select id="EgovOe1SmsScheduleDAO.selectScheduleLogList" parameterClass="scheLog" resultClass="egovMap">

			SELECT
				LOG_ID, LOG_SE, JOB_NM, JOB_GROUP_NM, JOB_EXECUT_TIME, LOG_MSSAGE
			FROM OE1TNSMSSCHELOG
			WHERE 1=1
			<isEqual prepend="AND" property="searchCondition" compareValue="0">
				LOG_SE LIKE '%'|| #searchKeyword# || '%'
			</isEqual>
			<isEqual prepend="AND" property="searchCondition" compareValue="1">
				JOB_NM LIKE '%' || #searchKeyword# || '%'
			</isEqual>
			<isEqual prepend="AND" property="searchCondition" compareValue="2">
				JOB_GROUP_NM LIKE '%' || #searchKeyword# || '%'
			</isEqual>
			ORDER BY LOG_ID DESC
			LIMIT #recordCountPerPage# OFFSET #firstIndex#		
	</select>
	
	<select id="EgovOe1SmsScheduleDAO.selectScheduleLogListTotCnt" parameterClass="scheLog" resultClass="int">

			SELECT COUNT(*) totcnt
			FROM OE1TNSMSSCHELOG
			WHERE 1=1
			<isEqual prepend="AND" property="searchCondition" compareValue="0">
				JOB_GROUP_NM LIKE '%' || #searchKeyword# || '%'
			</isEqual>
			<isEqual prepend="AND" property="searchCondition" compareValue="1">
				JOB_NM LIKE '%' || #searchKeyword# || '%'
			</isEqual>
			<isEqual prepend="AND" property="searchCondition" compareValue="2">
				LOG_SE LIKE '%'|| #searchKeyword# || '%'
			</isEqual>
	</select>
	
</sqlMap>
