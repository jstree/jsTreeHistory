<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript" src="./lib/jquery-1.11.2.min.js" charset="utf-8"></script>
</head>
<body>
	<div>
		<form id="form">
<!-- 			<div id="fileListDiv" style="display: none"></div> -->
			<div id="fileListDiv">
				<input id="fileInput0" name="files[]" type="file" />
			</div>
		</form>
		<button id="addFileBtn">추가</button>
		<button id="removeFileBtn">삭제</button>
	</div>
	<div>
		<select id="fileSelectBox" multiple="multiple">
		</select> 
	</div>
	
	<script>
		var FILE_ARR = [];
		var FILE_CNT_NUM = 0;
		
		$(document).ready(function(){
			
			// 파일추가 버튼
			$('#addFileBtn').click(function(){
				if(FILE_ARR.length >= 10) {
					alert('첨부파일은 10개까지 가능합니다.');
					return;
				}
				
				var fileID = 'fileInput' + FILE_CNT_NUM;
				var targetFileID = '#' + fileID;

				$(targetFileID).change(function(){
					if(this.value.length != 0) {	// 변경이 있을때만
						
						var fileName = this.value.split('\\').pop();
						
						$('#fileSelectBox').append( $('<option>', {
						    value: fileID,
						    text: fileName
						}));
						
						FILE_ARR.push(fileID);
						
						var inputStr = '<input id="fileInput' + ++FILE_CNT_NUM +'" name="files[]" type="file">';
						$('#fileListDiv').append(inputStr);
						
					}
				});
				
				$(targetFileID).trigger('click');
				
			});	
		
			// 파일 삭제 버튼
			$('#removeFileBtn').click(function(){
				$('#fileSelectBox option:selected').each(function(){
					$('#' + $(this).val()).remove();
					
					for(var i=0; i<FILE_ARR.length; i++) {
						if(FILE_ARR[i] == $(this).val()) {
							FILE_ARR.splice(i, 1);
							break;
						}
					}
					
					$(this).remove();
				});
			});			
			
			
		});	
		
		
	
	</script>
</body>
</html>